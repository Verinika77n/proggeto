{% extends 'base.html' %}
{% block content %}
  <h1 class="mb-3 text-center">Мой профиль</h1>

  {% if user.is_authenticated %}
    {% if entry and user.profile %}
      <div class="container" style="max-width: 700px;">
        <div class="row align-items-center mb-4">
          <div class="container" style="max-width: 700px;">
            {% if entry.photo %}
              <img src="{{ entry.photo.url }}" 
                   class="rounded-circle img-thumbnail"
                   alt="{{ entry.fname }} {{ entry.lname }}"
                   style="width:160px; height:160px; object-fit:cover;">
            {% else %}
              <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mx-auto"
                   style="width:160px; height:160px; color:white;">
                <span class="fs-1">{{ user.username|slice:":1"|upper }}</span>
              </div>
            {% endif %}
          </div>

          <div class="col-md-8">
            <h3 class="mb-1">
              {% if entry.fname or entry.lname %}
                {{ entry.fname }} {{ entry.lname }}
              {% else %}
                Без имени
              {% endif %}
            </h3>
            <p class="text-muted mb-2"><strong>Ник:</strong> {{ user.username }}</p>

            <ul class="list-group list-group-flush">
              {% if entry.phone %}
                <li class="list-group-item"><strong>Телефон:</strong> {{ entry.phone }}</li>
              {% endif %}
              {% if entry.birth_date %}
                <li class="list-group-item"><strong>Дата рождения:</strong> {{ entry.birth_date|date:"d.m.Y" }}</li>
              {% endif %}
              {% if entry.gender %}
                <li class="list-group-item"><strong>Пол:</strong> {{ entry.gender }}</li>
              {% endif %}
              {% if entry.about %}
                <li class="list-group-item"><strong>О себе:</strong> {{ entry.about }}</li>
              {% endif %}
            </ul>

            {% if not entry.phone and not entry.birth_date and not entry.gender and not entry.about and not entry.photo %}
              <div class="alert alert-info mt-3">
                У вас уже есть профиль, но данные ещё не заполнены.
              </div>
            {% endif %}

            <div class="mt-3">
              <a href="{% url 'profiles-edit' entry.pk %}" class="btn btn-primary">Редактировать</a>
            </div>

            <p class="text-muted mt-2">
              <small>Создано: {{ entry.created_at|date:"d.m.Y H:i" }}</small>
            </p>
          </div>
        </div>
      </div>
      
    {% else %}
      <div class="alert alert-warning text-center" style="max-width: 600px; margin: 0 auto;">
        У вас пока нет данных профиля.
      </div>
      <div class="text-center mt-3">
        <a href="{% url 'profiles-create' %}" class="btn btn-success">Заполнить профиль</a>
      </div>
    {% endif %}
  {% else %}
    <p class="text-center">Пожалуйста, войдите, чтобы просмотреть профиль.</p>
  {% endif %}
{% endblock %}
